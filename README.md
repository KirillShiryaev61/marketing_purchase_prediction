# –ü—Ä–æ–µ–∫—Ç: "–ë—É–¥—É—Ç –ª–∏ –æ–Ω–∏ –ø–æ–∫—É–ø–∞—Ç—å?" ‚Äî –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞

[üîó –ü—Ä–æ—Å–º–æ—Ç—Ä Jupyter Notebook —á–µ—Ä–µ–∑ nbviewer](https://nbviewer.org/github/KirillShiryaev61/marketing_purchase_prediction/blob/master/marketing_purchase_prediction.ipynb)

**–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:**

–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–≤–æ–¥–∏—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –±—É–¥—É—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏. –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞–¥–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—ã —Å–æ–≤–µ—Ä—à–∏—Ç—å –ø–æ–∫—É–ø–∫—É –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** ‚Äî –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ `90 –¥–Ω–µ–π`.

**–•–æ–¥ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:**

- `–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö`: –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–∑—É—á–µ–Ω–∏–µ –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.


- `–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:`: –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏–∑ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.


- `–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö`: –∏–∑—É—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –ø–æ–∏—Å–∫ –≤—ã–±—Ä–æ—Å–æ–≤/–∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö.


- `–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑`: –∏–∑—É—á–µ–Ω–∏–µ –≤–∑–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É –≤—Ö–æ–¥–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ —Ü–µ–ª–µ–≤—ã–º–∏, –∞ —Ç–∞–∫–∂–µ –∏ –º–µ–∂–¥—É –Ω–∏–º–∏.


- `–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤`: –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –µ–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.


- `–ü–æ–∏—Å–∫ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏`: –≥—Ä—É–±—ã–π –ø–æ–∏—Å–∫ –ª—É—á—à–∏—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é `GridSearchCV`, –ø–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞ –¥–ª—è –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é `RFECV`, –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ª—É—á—à–∏—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é `BayesSearchCV`, –æ–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º `soft-voting`, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.


- `–ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤`: –∞–Ω–∞–ª–∏–∑ —Å—Ç–µ–ø–µ–Ω–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏—Ö –≤–ª–∏—è–Ω–∏—è –Ω–∞ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª—å—é —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `SHAP`.


- `–û–±—â–∏–π –≤—ã–≤–æ–¥`: —Ä–µ–∑—é–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –≤—ã–≤–æ–¥–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.


**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã:**

–ë—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –∞–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º `soft_voting`, –≥–¥–µ –∫–∞–∂–¥–∞—è –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –Ω–∞–±–æ—Ä–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é `RFECV`, –∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞–Ω–∏—è `class_weight=balanced` –≤ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π. –ú–æ–¥–µ–ª—å –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –µ—ë –∫–∞—á–µ—Å—Ç–≤–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ `ROC-AUC` –Ω–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ `‚âà 0.0078`), –Ω–µ —Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ `LightGBM` –∏ `CatBoost`.

**–ú–µ—Ç—Ä–∏–∫–∏ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏:**

- Precision (—Ç–µ—Å—Ç): `0.0526`
- Recall (—Ç–µ—Å—Ç): `0.6458`
- PR-AUC (—Ç–µ—Å—Ç): `0.1033`
- ROC_AUC (—Ç–µ—Å—Ç): `0.7649`

**–û–±–æ–±—â–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

–ú–æ–¥–µ–ª—å —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª–∞–±—ã–π, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª: –µ—ë `PR-AUC (0.103)` –ø—Ä–∏–º–µ—Ä–Ω–æ **–≤ 5 —Ä–∞–∑ –≤—ã—à–µ**, —á–µ–º —É —Å–ª—É—á–∞–π–Ω–æ–π –º–æ–¥–µ–ª–∏ (–æ–∂–∏–¥–∞–µ–º—ã–π `baseline ‚âà 0.02` –ø—Ä–∏ –¥–æ–ª–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ **2%**).

–ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç **64%** –≤—Å–µ—Ö –∏—Å—Ç–∏–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (`Recall = 0.645`), –æ–¥–Ω–∞–∫–æ –ø–æ—á—Ç–∏ –≤—Å–µ –µ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ—à–∏–±–æ—á–Ω—ã: –ª–∏—à—å **5.2%** –∏–∑ –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –∫–∞–∫ –∫–ª–∞—Å—Å `1`, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —ç—Ç–æ–º—É –∫–ª–∞—Å—Å—É (`Precision = 0.052`), —á—Ç–æ —Ç–∏–ø–∏—á–Ω–æ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∏–∑–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å, —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ö–æ—Ä–æ—à–∞—è –æ—Ç–ø—Ä–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞. –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ: 

- –ò–∑—É—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è `–¢–û–ü-10` –ø–æ `SHAP` –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø–æ–º–æ–≥–∞—é—â–∏–µ –º–æ–¥–µ–ª–∏ –æ—Ç—Å–µ–∫–∞—Ç—å –æ—à–∏–±–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è;
- –ü—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –¥–æ–±–∏–≤–∞—è—Å—å –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤;
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –ø–æ –º–µ—Ç—Ä–∏–∫–µ `PR-AUC` (`Average Precision`);
- –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ–¥–æ–π—Ç–∏ –∫ –ø–æ–¥–±–æ—Ä—É –≤–µ—Å–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–æ–≤;
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—ã—à–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–º–µ—â–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –Ω–µ —É–ª—É—á—à–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é;
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –≤—ã–±–æ—Ä–∫–∏.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**

- **Data Processing**: `numpy`, `pandas`;
- **Visualization**: `matplotlib`, `seaborn`;
- **ML & Preprocessing**: `scikit-learn`, `skope`, `lightgbm`, `catboost`;
- **Statistical Analysis**: `scipy`, `statsmodels` (VIF, —Ç–µ—Å—Ç—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏);
- **Correlation Analysis**: `phik` ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —á–∏—Å–ª–æ–≤—ã–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏;
- **Model Interpretation**: `shap` ‚Äî –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–µ–π.